package com.amaz.onib;

import android.text.TextUtils;
import com.yf.y.f.init.util.ConstUtils;
import com.yuanlang.pay.plugin.libs.z;
import java.util.HashMap;
import java.util.Iterator;
import java.util.List;
/* loaded from: classes.dex */
public class cb {

    /* loaded from: classes.dex */
    public interface a {
        void a(h hVar, Exception exc, boolean z);
    }

    public static void a(h hVar, boolean z, a aVar) {
        String str = hVar.t;
        String str2 = hVar.p;
        try {
            try {
                r a2 = t.a(str);
                a2.a(30000);
                String a3 = a2.a();
                List<w> a4 = x.a(a3, "form[action=/play.msp]");
                if (a4 == null || a4.size() == 0) {
                    for (w wVar : x.a(a3, "a")) {
                        if (wVar.a("href") != null && wVar.a("href").startsWith(str2)) {
                            bs.a("TAG", "已经订购" + wVar.a("href"));
                            throw new ce(201, wVar.a("href"));
                        }
                    }
                    throw new ce(505, str + "[" + a3 + "]");
                }
                List<w> c = a4.get(0).c("input[name]");
                if (c == null || c.size() == 0) {
                    throw new ce(505, str + "[" + a3 + "]");
                }
                String substring = str.substring(0, str.indexOf("/", 10));
                String str3 = substring + "/play.msp";
                StringBuffer stringBuffer = new StringBuffer("[");
                HashMap hashMap = new HashMap();
                for (w wVar2 : c) {
                    hashMap.put(wVar2.a("name"), wVar2.a("value"));
                    stringBuffer.append("\n" + wVar2.a("name") + "=" + wVar2.a("value"));
                }
                stringBuffer.append("]");
                bs.a("TAG", "订购参数" + stringBuffer.toString());
                try {
                    r a5 = t.a(str3);
                    a5.a(ConstUtils.MIN);
                    a5.a(hashMap);
                    String b = a5.b();
                    String str4 = null;
                    Iterator<w> it = x.a(b, "a").iterator();
                    while (true) {
                        if (!it.hasNext()) {
                            break;
                        }
                        w next = it.next();
                        if (next.a("href") != null && next.a("href").startsWith("/order.msp")) {
                            str4 = next.a("href");
                            break;
                        }
                    }
                    if (!TextUtils.isEmpty(str4)) {
                        try {
                            r a6 = t.a(substring + str4);
                            a6.a(ConstUtils.MIN);
                            String a7 = a6.a();
                            for (w wVar3 : x.a(a7, "a")) {
                                if (wVar3.a("href") != null && wVar3.a("href").startsWith(str2)) {
                                    bs.a("TAG", "订购成功" + wVar3.a("href"));
                                    throw new ce(z.b, wVar3.a("href"));
                                }
                            }
                            throw new ce(507, substring + str4 + "[" + a7 + "]");
                        } catch (Exception e) {
                            throw new ce(407, substring + str4);
                        }
                    } else {
                        throw new ce(506, str3 + "[" + b + "]");
                    }
                } catch (Exception e2) {
                    throw new ce(406, str3 + stringBuffer.toString());
                }
            } catch (Exception e3) {
                throw new ce(405, str);
            }
        } catch (Exception e4) {
            aVar.a(hVar, e4, z);
            if (e4 instanceof ce) {
                ce ceVar = (ce) e4;
                bs.a("TAG", ceVar.a() + "#" + ceVar.b());
                return;
            }
            bs.a("TAG", "" + e4.getMessage());
            e4.printStackTrace();
        }
    }
}
