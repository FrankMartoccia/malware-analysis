package com.jy.publics;

import android.content.ComponentName;
import android.content.Context;
import android.content.Intent;
import android.content.ServiceConnection;
import android.os.Bundle;
import android.os.Handler;
import android.os.IBinder;
import android.os.Looper;
import android.os.RemoteException;
import android.util.Log;
import com.jy.a.a;
import com.jy.publics.service.JyService;
import com.jy.utils.LOG;
/* loaded from: classes.dex */
public class JyPaySDKMain {
    public static String FILENAME = "jypaysdk";
    public static final String PACKAGE_NAME = "com.jy.cc.JyPaySDK";
    public static final int SDK_PAY_INIT_FAIL = -1001;
    public static final int SDK_PAY_INIT_SUCCESSED = 1003;
    public static final String TAG = "JyPaySDKMain2";
    private static JyPaySDKMain sdkMain;
    JyService.a jyClientBinder;
    Handler mH = new Handler(Looper.getMainLooper());

    private JyPaySDKMain(Context context, String str) {
        LOG.init(context);
        context.getSharedPreferences("jy_dex_cnf", 0).edit().putString("d_name", str).commit();
        new Intent(context, JyService.class);
    }

    private void bindService(Context context, final Runnable runnable) {
        context.getApplicationContext().bindService(new Intent(context, JyService.class), new ServiceConnection() { // from class: com.jy.publics.JyPaySDKMain.1
            @Override // android.content.ServiceConnection
            public void onServiceConnected(ComponentName componentName, IBinder iBinder) {
                Log.d(JyPaySDKMain.TAG, "------- onServiceConnected jyClientBinder " + iBinder + " --------");
                JyPaySDKMain.this.jyClientBinder = (JyService.a) iBinder;
                if (runnable != null) {
                    JyPaySDKMain.this.mH.post(runnable);
                }
            }

            @Override // android.content.ServiceConnection
            public void onServiceDisconnected(ComponentName componentName) {
                JyPaySDKMain.this.jyClientBinder = null;
            }
        }, 1);
    }

    private static String getDexFileName(Context context) {
        String string = context.getSharedPreferences("jy_dex_cnf", 0).getString("d_name", null);
        return string == null ? FILENAME : string;
    }

    public static JyPaySDKMain getInstance(Context context, String str) {
        if (str != null) {
            FILENAME = str;
        }
        synchronized (JyPaySDKMain.class) {
            if (sdkMain == null) {
                sdkMain = new JyPaySDKMain(context, FILENAME);
            }
        }
        return sdkMain;
    }

    private void payImpl(Context context, final Handler handler, final Bundle bundle) {
        if (this.jyClientBinder == null) {
            bindService(context, new Runnable() { // from class: com.jy.publics.JyPaySDKMain.4
                @Override // java.lang.Runnable
                public void run() {
                    try {
                        JyPaySDKMain.this.jyClientBinder.b(handler);
                        JyPaySDKMain.this.jyClientBinder.b(bundle);
                    } catch (RemoteException e) {
                        e.printStackTrace();
                    }
                }
            });
        } else {
            this.mH.post(new Runnable() { // from class: com.jy.publics.JyPaySDKMain.5
                @Override // java.lang.Runnable
                public void run() {
                    try {
                        JyPaySDKMain.this.jyClientBinder.b(handler);
                        JyPaySDKMain.this.jyClientBinder.b(bundle);
                    } catch (RemoteException e) {
                        e.printStackTrace();
                    }
                }
            });
        }
    }

    private void startImpl(Context context, final Handler handler, final Bundle bundle) {
        LOG.e(TAG, "start impl " + this.jyClientBinder);
        if (this.jyClientBinder == null) {
            bindService(context, new Runnable() { // from class: com.jy.publics.JyPaySDKMain.2
                @Override // java.lang.Runnable
                public void run() {
                    try {
                        JyPaySDKMain.this.jyClientBinder.a(handler);
                        Log.d(JyPaySDKMain.TAG, "invoke initPay ret :" + JyPaySDKMain.this.jyClientBinder.a(bundle));
                    } catch (RemoteException e) {
                        e.printStackTrace();
                    }
                }
            });
        } else {
            this.mH.post(new Runnable() { // from class: com.jy.publics.JyPaySDKMain.3
                @Override // java.lang.Runnable
                public void run() {
                    try {
                        JyPaySDKMain.this.jyClientBinder.a(handler);
                        Log.e(JyPaySDKMain.TAG, "invoke initPay ret :" + JyPaySDKMain.this.jyClientBinder.a(bundle));
                    } catch (RemoteException e) {
                        e.printStackTrace();
                    }
                }
            });
        }
    }

    public void destroy() {
    }

    public void getSDKVersion(a<String> aVar) {
    }

    public void pay(Context context, Handler handler, Bundle bundle) {
        payImpl(context, handler, bundle);
    }

    public void pay(Context context, Handler handler, String str, String str2) {
        Bundle bundle = new Bundle();
        bundle.putString("orderNum", str2);
        bundle.putString("payID", str);
        payImpl(context, handler, bundle);
    }

    public void start(Context context, Handler handler, Bundle bundle) {
        startImpl(context, handler, bundle);
    }

    public void start(Context context, String str, String str2, Handler handler) {
        Bundle bundle = new Bundle();
        bundle.putString("appId", str);
        bundle.putString("channelId", str);
        startImpl(context, handler, bundle);
    }
}
