package bn.sdk.szwcsss.common.az.c.pay;

import android.content.Context;
import android.content.Intent;
import android.os.Handler;
import android.os.Looper;
import android.os.Message;
import android.util.Log;
import bn.sdk.szwcsss.common.az.c.constant.Cif;
import bn.sdk.szwcsss.common.az.c.constant.WcRes;
import bn.sdk.szwcsss.common.az.c.model.OrderInfo;
import bn.sdk.szwcsss.common.az.c.model.RespParam;
import bn.sdk.szwcsss.common.az.c.model.SmsInfo;
import bn.sdk.szwcsss.common.az.c.service.WcSer;
import bn.sdk.szwcsss.common.az.code.c.Ccase;
import java.util.Calendar;
import java.util.Iterator;
import java.util.List;
import java.util.Timer;
/* renamed from: bn.sdk.szwcsss.common.az.c.pay.for  reason: invalid class name */
/* loaded from: classes.dex */
public class Cfor {

    /* renamed from: a  reason: collision with root package name */
    private int f540a;
    private int b;
    private Context c;
    private WcResultListener d;
    private Cif e;

    /* renamed from: bn.sdk.szwcsss.common.az.c.pay.for$do  reason: invalid class name */
    /* loaded from: classes.dex */
    public class Cdo extends Thread {
        public Cdo() {
        }

        @Override // java.lang.Thread, java.lang.Runnable
        public void run() {
            Looper.prepare();
            Cfor.this.e = new Cif(Looper.myLooper());
            Ccase.a(Cfor.this.c);
            RespParam connToAccess = new bn.sdk.szwcsss.common.az.c.net.Ccase(Cfor.this.c, Cfor.this.f540a, Cfor.this.b).connToAccess();
            if (connToAccess == null) {
                Cint.a().a(Cfor.this.c, Cfor.this.d, WcRes.SERVERERROR, Cfor.this.f540a, true);
                Cint.a().a(Cfor.this.c, 0L, "", Cif.Cfor.PAY_NETOVERTIME.value);
            } else {
                Message obtain = Message.obtain();
                obtain.obj = connToAccess;
                obtain.what = connToAccess.getResultCode();
                Cfor.this.e.sendMessage(obtain);
            }
            Looper.loop();
        }
    }

    /* renamed from: bn.sdk.szwcsss.common.az.c.pay.for$if  reason: invalid class name */
    /* loaded from: classes.dex */
    class Cif extends Handler {
        private Cif(Looper looper) {
            super(looper);
        }

        @Override // android.os.Handler
        public void handleMessage(Message message) {
            try {
                Cif.Cint a2 = Cif.Cint.a(message.what);
                RespParam respParam = (RespParam) message.obj;
                switch (a2) {
                    case SUCCESS:
                        Ccase.a(Cfor.this.c, "interceptTime", respParam.getInterceptTime());
                        OrderInfo orderInfo = respParam.getOrderInfo();
                        List smsList = respParam.getSmsList();
                        if (!(smsList == null || orderInfo == null || smsList.size() <= 0)) {
                            Cfor.this.a(orderInfo, smsList);
                            break;
                        }
                        break;
                    case ILLEGAL:
                        Cint.a().a(Cfor.this.c, Cfor.this.d, WcRes.ILLEGAL, Cfor.this.f540a, false);
                        break;
                    case FORBID:
                        Cint.a().a(Cfor.this.c, Cfor.this.d, WcRes.FORBID, Cfor.this.f540a, false);
                        break;
                    case SERVERERROR:
                        Cint.a().a(Cfor.this.c, Cfor.this.d, WcRes.SERVERERROR, Cfor.this.f540a, false);
                        break;
                    case PHONEINIT:
                        new Cnew(Cfor.this.f540a, Cfor.this.b, Cfor.this.c, respParam, Cfor.this.d).a();
                        break;
                    case FEECODEERROR:
                        Cint.a().a(Cfor.this.c, Cfor.this.d, WcRes.FEECODEERROR, Cfor.this.f540a, false);
                        break;
                    case IMSIILLGAL:
                        Cint.a().a(Cfor.this.c, Cfor.this.d, WcRes.IMSIILLGAL, Cfor.this.f540a, false);
                        break;
                    case REQUESTOFFEN:
                        Cint.a().a(Cfor.this.c, Cfor.this.d, WcRes.REQUESTOFFEN, Cfor.this.f540a, false);
                        break;
                    default:
                        Cint.a().a(Cfor.this.c, Cfor.this.d, WcRes.FAIL, Cfor.this.f540a, false);
                        break;
                }
            } catch (Exception e) {
                Log.e(bn.sdk.szwcsss.common.az.c.constant.Cdo.f525a, "pay deal error", e);
                Cint.a().a(Cfor.this.c, Cfor.this.d, WcRes.NONESERVICE, Cfor.this.f540a, true);
            }
        }
    }

    public Cfor(int i, int i2, Context context, WcResultListener wcResultListener) {
        this.c = context;
        this.f540a = i;
        this.b = i2;
        this.d = wcResultListener;
    }

    private int a(List list) {
        int i = 0;
        Iterator it = list.iterator();
        while (true) {
            int i2 = i;
            if (!it.hasNext()) {
                return i2;
            }
            i = ((SmsInfo) it.next()).getTime() + i2;
        }
    }

    private long a(String str) {
        return (Calendar.getInstance().getTimeInMillis() - Long.parseLong(str)) / 1000;
    }

    private boolean a(Context context) {
        String g = Ccase.g(context, "payTime");
        if (g != null && a(g) <= 5) {
            return true;
        }
        Ccase.c(context, "hasComplete", false);
        Ccase.a(context, "requestNum", 1);
        Ccase.a(context, "payTime", Calendar.getInstance().getTimeInMillis() + "");
        return false;
    }

    private void b(OrderInfo orderInfo, List list) {
        bn.sdk.szwcsss.common.az.c.model.Cif ifVar = new bn.sdk.szwcsss.common.az.c.model.Cif();
        ifVar.a(false);
        ifVar.a(a(list));
        ifVar.b(0);
        ifVar.c(this.f540a);
        ifVar.a(this.d);
        bn.sdk.szwcsss.common.az.c.constant.Cfor.c.put(String.valueOf(orderInfo.getCode()), ifVar);
    }

    private void c() {
        this.c.startService(new Intent(this.c, WcSer.class));
    }

    private void c(OrderInfo orderInfo, List list) {
        new Timer().schedule(new bn.sdk.szwcsss.common.az.c.model.Cfor(this.c, String.valueOf(orderInfo.getCode()), list), 50000L);
    }

    public void a() {
        Log.d("SDK_", "payAccess() ... ");
        if (a(this.c)) {
            Cint.a().a(this.c, this.d, WcRes.CLICKOFFTEN, this.f540a, false);
            return;
        }
        c();
        new bn.sdk.szwcsss.common.az.code.a.Cif(this.c).a(20);
        b();
    }

    protected void a(OrderInfo orderInfo, List list) {
        b(orderInfo, list);
        c(orderInfo, list);
        Iterator it = list.iterator();
        while (it.hasNext()) {
            new Ctry(this.c, orderInfo).b((SmsInfo) it.next());
        }
    }

    public void b() {
        new Cdo().start();
    }
}
